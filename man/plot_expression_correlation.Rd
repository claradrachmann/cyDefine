% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/06_visualize.R
\name{plot_expression_correlation}
\alias{plot_expression_correlation}
\title{Plot correlation of marker expression between reference and query by cell type}
\usage{
plot_expression_correlation(
  reference,
  query = NULL,
  markers,
  ref_col = "celltype",
  query_col = "model_prediction",
  ref_name = "Reference",
  query_name = "Query",
  celltypes_to_plot = NULL,
  ncol = 3,
  point_size = 3,
  marker_colors = NULL
)
}
\arguments{
\item{reference}{Tibble of reference data or a list containing reference and query data.
If a list, should contain elements named 'reference' and 'query'}

\item{query}{Tibble of query data (cells in rows). Ignored if reference is a list}

\item{markers}{Character vector of marker names (column names) to include in analysis}

\item{ref_col}{Character string specifying the column name containing cell types
in the reference dataset (default "celltype")}

\item{query_col}{Character string specifying the column name containing cell types
in the query dataset (default "model_prediction")}

\item{ref_name}{Character string for reference dataset label (default "Reference")}

\item{query_name}{Character string for query dataset label (default "Query")}

\item{celltypes_to_plot}{Character vector of specific cell types to include. If NULL,
uses intersection of cell types present in both datasets}

\item{ncol}{Integer specifying number of columns in facet layout (default 3)}

\item{point_size}{Numeric value for point size in scatter plots (default 3)}

\item{marker_colors}{Named vector of colors for markers. If NULL, generates colors
automatically using cyDefine::get_distinct_colors()}
}
\value{
ggplot2 object showing faceted correlation plots with R-squared values
}
\description{
Creates faceted scatter plots showing the correlation between mean marker expression
in reference and query datasets for each cell type. Each plot includes a linear
regression line and displays the R-squared correlation coefficient.
}
